%% Copyright (C) 2023 Alessandro Clerici Lorenzini
%
% This work may be distributed and/or modified under the
% conditions of the LaTeX Project Public License, either version 1.3
% of this license or (at your option) any later version.
% The latest version of this license is in
%   http://www.latex-project.org/lppl.txt
% and version 1.3 or later is part of all distributions of LaTeX
% version 2005/12/01 or later.
%
% This work has the LPPL maintenance status `maintained'.
%
% The Current Maintainer of this work is Alessandro Clerici Lorenzini
%
% This work consists of the files listed in work.txt


\section{Tempo medio di rientro finito per gli stati ricorrenti}


\subsection{Requisiti}
\begin{prop}\label{prop:transconver}
	In una catena di Markov di matrice di transizione $P$ e insieme degli stati $S$, sia $j\in S$ transiente. Allora esiste $\epsilon$ tale che $0\le\epsilon<1$ e, per $n\to+\infty$:
	\begin{equation*}
		P\ape{n}(i,j) = O(\epsilon^n) \text.
	\end{equation*}
\end{prop}


\subsection{Teorema}
\begin{prop}\label{prop:ricorconv}
	In una catena di Markov di insieme degli stati $S$, sia $j\in S$ ricorrente. Allora esiste $\epsilon$ tale che $0\le\epsilon<1$ e, per $n\to+\infty$:
	\begin{equation*}
		f\ape{n}(i,i) = O(\epsilon^n) \text.
	\end{equation*}
\end{prop}
\begin{proof}
	Chiamata $P$ Ã¨ la matrice di transizione della catena, definiamo una catena sull'insieme di stati $[i]$ e la matrice di transizione $\tilde P$, che rende $i$ l'unico stato assorbente:
	\begin{gather*}
		\tilde P(i,j) := \indic(j=i) \qquad\forall j\in[i] \\
		\tilde P(h,j) := P(h,j) \qquad\forall h,j\in[i], h\neq i \text.
	\end{gather*}
	Allora vale la seguente scomposizione per $f\ape{n}(i,i)$ (si tenga presente che i cammini rappresentati da tale funzione non passano per $i$ se non all'inizio e alla fine), con $n\ge2$:
	\begin{align*}
		f\ape{n}(i,i) & = \sum_{h,j\in[i]\setminus\{i\}} P(i,h)\cdot\underbrace{\tilde P\ape{n-2}(h,j)}_{O(\epsilon^n)\text{ per proposizione \ref{prop:transconver}}}\cdot P(j,i) \\
		              & = O(\epsilon^n)\cdot O(1) = O(\epsilon^n) \text. \qedhere
	\end{align*}
\end{proof}

\begin{thm}
	In una catena di Markov di insieme degli stati $S$, sia $i\in S$ ricorrente. Allora $\ev_i(\tau_i)<+\infty$.
\end{thm}
\begin{proof}
	Per definizione e applicando la proposizione \ref{prop:ricorconv}:
	\begin{equation*}
		\ev_i(\tau_i) = \sum_{n\ge1} nf\ape{n}(i,i) = \sum_{n\ge1} nO(\epsilon^n) < +\infty
	\end{equation*}
\end{proof}
